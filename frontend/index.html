<!DOCTYPE html>
<html>
<head>
  <title>Ma application Vue avec Apollo Client</title>
  <script src="https://unpkg.com/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/apollo-boost@0.4.7/dist/apollo.min.js"></script>
</head>
<body>
  <div id="app">
    <h1>Ma application Vue avec Apollo Client</h1>
    <form @submit.prevent="createCategory">
      <div>
        <label for="name">Nom de la catégorie:</label>
        <input type="text" id="name" v-model="categoryName" required>
      </div>
      <div>
        <label for="image">Image:</label>
        <input type="file" id="image" @change="handleImageUpload">
      </div>
      <button type="submit">Créer la catégorie</button>
    </form>
  </div>

  <script>
    // Import ApolloClient from apollo-boost package
import { ApolloClient, InMemoryCache, ApolloProvider, gql } from '@apollo/client';

    // Create an instance of ApolloClient
    const apolloClient = new ApolloClient({
      uri: '127.0.0.1:8000/graphql', // URL de votre serveur GraphQL
    });

    // Initialize your Vue application with Apollo
    new Vue({
      el: '#app',
      data() {
        return {
          categoryName: '',
          image: null,
        };
      },
      methods: {
        handleImageUpload(event) {
          this.image = event.target.files[0];
        },
        async createCategory() {
          const mutation = gql`
            mutation($name: String!, $image: Upload) {
              createCategory(name: $name, image: $image) {
                category {
                  id
                  name
                  image
                }
              }
            }
          `;
          const variables = {
            name: this.categoryName,
            image: this.image,
          };
          const response = await apolloClient.mutate({ mutation, variables });
          console.log(response.data.createCategory);
          // Do something with the response, such as reset the form
          this.categoryName = '';
          this.image = null;
        },
      },
    });
  </script>
</body>
</html>
